(this.webpackJsonpmesto=this.webpackJsonpmesto||[]).push([[0],{12:function(e,t,a){e.exports=a(18)},17:function(e,t,a){},18:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(6),c=a.n(r),i=(a(17),a(11)),s=a(2),l=a(1),u=a(7),d=a.n(u);var p=function(){return o.a.createElement("header",{className:"header"},o.a.createElement("img",{className:"logo",src:d.a,alt:"\u043b\u043e\u0433\u043e"}))},m=o.a.createContext();var f=function(e){var t=o.a.useContext(m),a=e.card,n=e.onCardClick,r=e.onCardLike,c=e.onCardDelete,i=a.owner._id===t._id,s="card__trash ".concat(i?"":"card__trash_hidden"),l=a.likes.some((function(e){return e._id===t._id})),u="card__like-btn ".concat(l?"card__like-btn_active":""),d={backgroundImage:"url(".concat(a.link,")")};return o.a.createElement("div",{className:"card",key:a._id},o.a.createElement("div",{className:"card__image",onClick:function(){n(a)},style:d}),o.a.createElement("div",{className:"card__description"},o.a.createElement("h3",{className:"card__title"},a.name),o.a.createElement("div",{className:"card__like"},o.a.createElement("button",{className:u,onClick:function(){r(a)},type:"button"}),o.a.createElement("span",{className:"card__like-counter"},a.likes.length))),o.a.createElement("button",{className:s,type:"button",onClick:function(){c(a)}}))},_=a(8),h=a.n(_);var b=function(e){var t=o.a.useContext(m);return o.a.createElement("main",{className:"content"},o.a.createElement("section",{className:"profile"},o.a.createElement("div",{className:"profile__box"},o.a.createElement("img",{className:"profile__avatar",src:t.avatar,alt:"\u0430\u0432\u0430\u0442\u0430\u0440"}),o.a.createElement("img",{className:"profile__pencil",onClick:e.onEditAvatar,src:h.a,alt:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})),o.a.createElement("div",{className:"profile__info"},o.a.createElement("div",null,o.a.createElement("h1",{className:"profile__name","data-id":""},t.name),o.a.createElement("p",{className:"profile__description"},t.about)),o.a.createElement("button",{className:"profile__edit-button",onClick:e.onEditProfile,type:"button"})),o.a.createElement("button",{className:"add-button",onClick:e.onAddPlace,type:"button"})),o.a.createElement("section",{className:"cards"},e.cards.map((function(t){return o.a.createElement(f,{key:t._id,card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete})}))))};var v=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 \u0421\u0430\u043c\u0438\u0440\u0430"))};var E=function(e){return o.a.createElement("section",{className:e.card.isOpen?"popup popup_opened":"popup",id:"view-image"},o.a.createElement("figure",{className:"popup__view"},o.a.createElement("button",{className:"popup__close",id:"close-view",onClick:e.onClose,type:"button"},"+"),o.a.createElement("img",{className:"popup__image",alt:e.card.name,src:e.card.link}),o.a.createElement("figcaption",{className:"popup__caption"},e.card.name)))},g=a(9),k=a(10),C={authorization:"34b93c83-0a5b-42af-bf4b-3169bf836bcd",baseUrl:"https://mesto.nomoreparties.co/v1/cohort-12"},N=new(function(){function e(t){Object(g.a)(this,e),this._url=t.baseUrl,this._headers=t.headers}return Object(k.a)(e,[{key:"getInitialCards",value:function(){return fetch("".concat(this._url,"/cards"),{method:"GET",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status))}))}},{key:"getUserInfo",value:function(){return fetch("".concat(this._url,"/users/me"),{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status))}))}},{key:"editUserInfo",value:function(e){return fetch("".concat(this._url,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then((function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status))}))}},{key:"editUserAvatar",value:function(e){return fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then((function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status))}))}},{key:"addNewCard",value:function(e){return fetch("".concat(this._url,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then((function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status))}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this._url,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status))}))}},{key:"changeLikeCardStatus",value:function(e,t){return fetch("".concat(this._url,"/cards/likes/").concat(e),{method:"".concat(t?"PUT":"DELETE"),headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status))}))}},{key:"deleteLike",value:function(e){return fetch("".concat(this._url,"/cards/likes/").concat(e._id),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status))}))}}]),e}())({baseUrl:C.baseUrl,headers:{authorization:C.authorization,"Content-Type":"application/json"}});var O=function(e){return o.a.createElement("section",{className:e.isOpen?"popup popup_opened":"popup",id:e.name},o.a.createElement("div",{className:"popup__content",id:"edit-popup-form"},o.a.createElement("button",{className:"popup__close",onClick:e.onClose,id:"popup-close-edit",type:"button"},"+"),o.a.createElement("form",{onSubmit:e.onSubmit,className:"popup__form popup__edit_profile",name:"edit"},o.a.createElement("h3",{className:"popup__heading"},e.heading),e.children,o.a.createElement("button",{className:"popup__save-btn",id:"popup-save-btn",type:"submit"},e.isLoading?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...":e.buttonText))))};var j=function(e){var t=o.a.useContext(m),a=o.a.useState(""),n=Object(l.a)(a,2),r=n[0],c=n[1],i=o.a.useState(""),s=Object(l.a)(i,2),u=s[0],d=s[1];return o.a.useEffect((function(){c(t.name),d(t.about)}),[t]),o.a.createElement(O,{isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:r,about:u})},heading:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isLoading:e.isLoading},o.a.createElement("input",{className:"popup__field popup__field_name",onChange:function(e){c(e.target.value)},value:r,id:"name-field",placeholder:"\u0418\u043c\u044f",type:"text",name:"name",pattern:"[A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451 -]*",minLength:"2",maxLength:"40",required:!0}),o.a.createElement("span",{className:"popup__span-error",id:"name-field-error"}),o.a.createElement("input",{className:"popup__field popup__field_job",value:u,onChange:function(e){d(e.target.value)},id:"job-field",placeholder:"\u041e \u0441\u0435\u0431\u0435",type:"text",name:"about",required:!0,minLength:"2",maxLength:"200"}),o.a.createElement("span",{className:"popup__span-error",id:"job-field-error"}))};var y=function(e){var t=o.a.useContext(m),a=o.a.useRef();return o.a.useEffect((function(){a.current.value=""}),[t]),o.a.createElement(O,{isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateAvatar({avatar:a.current.value})},heading:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440?",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isLoading:e.isLoading},o.a.createElement("input",{className:"popup__field popup__field_avatar",ref:a,onChange:function(){a.current.focus()},id:"url-input",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",type:"url",name:"link",required:!0}),o.a.createElement("span",{className:"popup__span-error",id:"url-input-error"}))};var L=function(e){var t=o.a.useState({name:"",link:""}),a=Object(l.a)(t,2),n=a[0],r=a[1];return o.a.useEffect((function(){r({name:"",link:""})}),[e.isOpen]),o.a.createElement(O,{isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateCard(n)},heading:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isLoading:e.isLoading},o.a.createElement("input",{className:"popup__field popup__field_card",id:"title-input",onChange:function(e){r(Object(s.a)(Object(s.a)({},n),{},{name:e.target.value}))},placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",type:"text",name:"name",value:n.name,required:!0,minLength:"1",maxLength:"30"}),o.a.createElement("span",{className:"popup__span-error",id:"title-input-error"}),o.a.createElement("input",{className:"popup__field popup__field_link",onChange:function(e){r(Object(s.a)(Object(s.a)({},n),{},{link:e.target.value}))},value:n.link,id:"url-input",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",type:"url",required:!0,name:"link"}),o.a.createElement("span",{className:"popup__span-error",id:"url-input-error"}))};var S=function(e){return o.a.createElement(O,{heading:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonText:"\u0414\u0430",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onConfirmClick()}})};var x=function(){var e=o.a.useState(!1),t=Object(l.a)(e,2),a=t[0],n=t[1],r=o.a.useState(!1),c=Object(l.a)(r,2),u=c[0],d=c[1],f=o.a.useState(!1),_=Object(l.a)(f,2),h=_[0],g=_[1],k=o.a.useState(!1),C=Object(l.a)(k,2),O=C[0],x=C[1],U=o.a.useState([]),P=Object(l.a)(U,2),w=P[0],T=P[1],A=o.a.useState({name:"",about:"",avatar:"",_id:""}),D=Object(l.a)(A,2),I=D[0],q=D[1],J=o.a.useState(!1),z=Object(l.a)(J,2),B=z[0],H=z[1],W=o.a.useState({}),G=Object(l.a)(W,2),M=G[0],R=G[1],Z=o.a.useState({isOpen:!1,name:"",link:""}),$=Object(l.a)(Z,2),F=$[0],K=$[1];function Q(){g(!1),n(!1),d(!1),x(!1),K(!1)}return o.a.useEffect((function(){Promise.all([N.getUserInfo(),N.getInitialCards()]).then((function(e){var t=Object(l.a)(e,2),a=t[0],n=t[1];T(n),q(a)})).catch((function(e){return console.log(e)}))}),[]),o.a.createElement(m.Provider,{value:I},o.a.createElement("div",{className:"page"},o.a.createElement(p,null),o.a.createElement(b,{onEditProfile:function(){n(!0)},onAddPlace:function(){d(!0)},onEditAvatar:function(){g(!0)},onCardClick:function(e){K({isOpen:!0,name:e.name,link:e.link})},cards:w,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===I._id}));N.changeLikeCardStatus(e._id,!t).then((function(t){var a=w.map((function(a){return a._id===e._id?t:a}));T(a)}))},onCardDelete:function(e){R(e),x(!0)}}),o.a.createElement(S,{isOpen:O,onClose:Q,onConfirmClick:function(){N.deleteCard(M._id).then((function(){var e=w.filter((function(e){return e._id!==M._id}));T(e),Q()})).catch((function(e){return console.log(e)}))}}),o.a.createElement(y,{isOpen:h,onClose:Q,onUpdateAvatar:function(e){H(!0),N.editUserAvatar(e).then((function(e){q(Object(s.a)(Object(s.a)({},I),{},{avatar:e.avatar})),Q()})).catch((function(e){return console.log(e)})).finally((function(){return H(!1)}))},isLoading:B}),o.a.createElement(j,{isOpen:a,onClose:Q,onUpdateUser:function(e){H(!0),N.editUserInfo(e).then((function(e){q(Object(s.a)(Object(s.a)({},I),{},{name:e.name,about:e.about})),Q()})).catch((function(e){return console.log(e)})).finally((function(){return H(!1)}))},isLoading:B}),o.a.createElement(L,{isOpen:u,onClose:Q,onUpdateCard:function(e){H(!0),N.addNewCard(e).then((function(e){T([].concat(Object(i.a)(w),[e])),Q()})).catch((function(e){return console.log(e)})).finally((function(){return H(!1)}))},isLoading:B}),o.a.createElement(E,{card:F,onClose:Q}),o.a.createElement(v,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(x,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},7:function(e,t,a){e.exports=a.p+"static/media/logo.c6f11019.svg"},8:function(e,t,a){e.exports=a.p+"static/media/pencil.9a053c9f.svg"}},[[12,1,2]]]);
//# sourceMappingURL=main.1a55c5de.chunk.js.map